arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "West") |>
arrange(desc(flav_spent)) |>
head(5)) +
facet_wrap(~ region,
scales = "free_x",
nrow = 1) +
theme_minimal()+
theme(legend.position = "bottom",
legend.title = "Flavor"
axis.text.x = element_text(angle = 45,
ggplot(data = tot_spent_flavor,
mapping = aes(x = fct_reorder(flavor_descr,
flav_spent,
na.rm = T),
y = flav_spent,
fill = flavor_descr))+
geom_col(data = tot_spent_flavor |>
filter(region == "Central") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "East") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "South") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "West") |>
arrange(desc(flav_spent)) |>
head(5)) +
facet_wrap(~ region,
scales = "free_x",
nrow = 1) +
theme_minimal()+
theme(legend.position = "bottom",
legend.title = "Flavor",
axis.text.x = element_text(angle = 45,
size = 4))+
scale_fill_viridis_d()+
labs(x = "",
y = "Total Money Spent",
title = "Top 5 Flavors Sold by Region")
ggplot(data = tot_spent_flavor,
mapping = aes(x = fct_reorder(flavor_descr,
flav_spent,
na.rm = T),
y = flav_spent,
fill = flavor_descr))+
geom_col(data = tot_spent_flavor |>
filter(region == "Central") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "East") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "South") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "West") |>
arrange(desc(flav_spent)) |>
head(5)) +
facet_wrap(~ region,
scales = "free_x",
nrow = 1) +
theme_minimal()+
theme(legend.position = "bottom",
legend.title = element_text(text = "Flavor"),
axis.text.x = element_text(angle = 45,
size = 4))+
scale_fill_viridis_d()+
labs(x = "",
y = "Total Money Spent",
title = "Top 5 Flavors Sold by Region")
ggplot(data = tot_spent_flavor,
mapping = aes(x = fct_reorder(flavor_descr,
flav_spent,
na.rm = T),
y = flav_spent,
fill = flavor_descr))+
geom_col(data = tot_spent_flavor |>
filter(region == "Central") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "East") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "South") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "West") |>
arrange(desc(flav_spent)) |>
head(5)) +
facet_wrap(~ region,
scales = "free_x",
nrow = 1) +
theme_minimal()+
theme(legend.position = "bottom",
axis.text.x = element_text(angle = 45,
size = 4))+
scale_fill_viridis_d()+
labs(x = "",
y = "Total Money Spent",
title = "Top 5 Flavors Sold by Region",
fill = "Flavor")
ggplot(data = tot_spent_flavor,
mapping = aes(x = fct_reorder(flavor_descr,
flav_spent,
na.rm = T),
y = flav_spent,
fill = flavor_descr))+
geom_col(data = tot_spent_flavor |>
filter(region == "Central") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "East") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "South") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "West") |>
arrange(desc(flav_spent)) |>
head(5)) +
facet_wrap(~ region,
scales = "free_x",
nrow = 1) +
theme_minimal()+
theme(legend.position = "bottom",
legend.key.size = 8,
axis.text.x = element_text(angle = 45,
size = 4))+
scale_fill_viridis_d()+
labs(x = "",
y = "Total Money Spent",
title = "Top 5 Flavors Sold by Region",
fill = "Flavor")
ggplot(data = tot_spent_flavor,
mapping = aes(x = fct_reorder(flavor_descr,
flav_spent,
na.rm = T),
y = flav_spent,
fill = flavor_descr))+
geom_col(data = tot_spent_flavor |>
filter(region == "Central") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "East") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "South") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "West") |>
arrange(desc(flav_spent)) |>
head(5)) +
facet_wrap(~ region,
scales = "free_x",
nrow = 1) +
theme_minimal()+
theme(legend.position = "bottom",
legend.key.size = unit(8),
axis.text.x = element_text(angle = 45,
size = 4))+
scale_fill_viridis_d()+
labs(x = "",
y = "Total Money Spent",
title = "Top 5 Flavors Sold by Region",
fill = "Flavor")
ggplot(data = tot_spent_flavor,
mapping = aes(x = fct_reorder(flavor_descr,
flav_spent,
na.rm = T),
y = flav_spent,
fill = flavor_descr))+
geom_col(data = tot_spent_flavor |>
filter(region == "Central") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "East") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "South") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "West") |>
arrange(desc(flav_spent)) |>
head(5)) +
facet_wrap(~ region,
scales = "free_x",
nrow = 1) +
theme_minimal()+
theme(legend.position = "bottom",
legend.key.size = unit(8, "pt"),
axis.text.x = element_text(angle = 45,
size = 4))+
scale_fill_viridis_d()+
labs(x = "",
y = "Total Money Spent",
title = "Top 5 Flavors Sold by Region",
fill = "Flavor")
ggplot(data = tot_spent_flavor,
mapping = aes(x = fct_reorder(flavor_descr,
flav_spent,
na.rm = T),
y = flav_spent,
fill = flavor_descr))+
geom_col(data = tot_spent_flavor |>
filter(region == "Central") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "East") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "South") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "West") |>
arrange(desc(flav_spent)) |>
head(5)) +
facet_wrap(~ region,
scales = "free_x",
nrow = 1) +
theme_bw()+
theme(legend.position = "bottom",
legend.key.size = unit(8, "pt"),
axis.text.x = element_text(angle = 45,
size = 4))+
scale_fill_viridis_d()+
labs(x = "",
y = "Total Money Spent",
title = "Top 5 Flavors Sold by Region",
fill = "Flavor")
ggplot(data = tot_spent_flavor,
mapping = aes(x = fct_reorder(flavor_descr,
flav_spent,
na.rm = T),
y = flav_spent,
fill = flavor_descr))+
geom_col(data = tot_spent_flavor |>
filter(region == "Central") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "East") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "South") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "West") |>
arrange(desc(flav_spent)) |>
head(5)) +
facet_wrap(~ region,
scales = "free_x",
nrow = 1) +
theme_bw()+
theme(legend.position = "bottom",
legend.key.size = unit(8, "pt"),
axis.text.x = element_text(angle = 45,
size = 4))+
scale_fill_viridis_d()+
scale_y_continuous(labels = scales :: dollar) +
labs(x = "",
y = "Total Money Spent",
title = "Top 5 Flavors Sold by Region",
fill = "Flavor")
library(tidyverse)
library(skimr)
library(ggrepel)
ice_cream <- read_csv('https://bcdanl.github.io/data/ben-and-jerry-cleaned.csv')
DT::datatable(ice_cream |> head(100))
ggplot(data = tot_spent_flavor,
mapping = aes(x = fct_reorder(flavor_descr,
flav_spent,
na.rm = T),
y = flav_spent,
fill = flavor_descr))+
geom_col(data = tot_spent_flavor |>
filter(region == "Central") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "East") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "South") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "West") |>
arrange(desc(flav_spent)) |>
head(5)) +
facet_wrap(~ region,
scales = "free_x",
nrow = 1) +
theme_bw()+
theme(legend.position = "bottom",
legend.key.size = unit(8, "pt"),
axis.text.x = element_text(angle = 45,
size = 4))+
scale_fill_viridis_d()+
scale_y_continuous(labels = scales :: dollar) +
labs(x = "",
y = "Total Money Spent",
title = "Top 5 Flavors Sold by Region",
fill = "Flavor")
tot_spent_flavor <- ice_cream |>
group_by(flavor_descr, region) |>
summarize(flav_spent = sum(priceper1))
ggplot(data = tot_spent_flavor,
mapping = aes(x = fct_reorder(flavor_descr,
flav_spent,
na.rm = T),
y = flav_spent,
fill = flavor_descr))+
geom_col(data = tot_spent_flavor |>
filter(region == "Central") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "East") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "South") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "West") |>
arrange(desc(flav_spent)) |>
head(5)) +
facet_wrap(~ region,
scales = "free_x",
nrow = 1) +
theme_bw()+
theme(legend.position = "bottom",
legend.key.size = unit(8, "pt"),
axis.text.x = element_text(angle = 45,
size = 4))+
scale_fill_viridis_d()+
scale_y_continuous(labels = scales :: dollar) +
labs(x = "",
y = "Total Money Spent",
title = "Top 5 Flavors Sold by Region",
fill = "Flavor")
ggplot(data = tot_spent_flavor,
mapping = aes(x = fct_reorder(flavor_descr,
flav_spent,
na.rm = T),
y = flav_spent,
fill = flavor_descr))+
geom_col(data = tot_spent_flavor |>
filter(region == "Central") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "East") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "South") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "West") |>
arrange(desc(flav_spent)) |>
head(5)) +
facet_wrap(~ region,
scales = "free_x",
nrow = 1) +
theme_bw()+
theme(legend.position = "none",
legend.key.size = unit(8, "pt"),
axis.text.x = element_text(angle = 45,
size = 4))+
scale_fill_viridis_d()+
scale_y_continuous(labels = scales :: dollar) +
labs(x = "",
y = "Total Money Spent",
title = "Top 5 Flavors Sold by Region",
fill = "Flavor")
ggplot(data = tot_spent_flavor,
mapping = aes(x = fct_reorder(flavor_descr,
flav_spent,
na.rm = T),
y = flav_spent,
fill = flavor_descr))+
geom_col(data = tot_spent_flavor |>
filter(region == "Central") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "East") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "South") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "West") |>
arrange(desc(flav_spent)) |>
head(5)) +
facet_wrap(~ region,
scales = "free_x",
nrow = 1) +
theme_bw()+
theme(legend.position = "bottom",
legend.key.size = unit(8, "pt"),
axis.text.x = "")+
scale_fill_viridis_d()+
scale_y_continuous(labels = scales :: dollar) +
labs(x = "",
y = "Total Money Spent",
title = "Top 5 Flavors Sold by Region",
fill = "Flavor")
ggplot(data = tot_spent_flavor,
mapping = aes(x = fct_reorder(flavor_descr,
flav_spent,
na.rm = T),
y = flav_spent,
fill = flavor_descr))+
geom_col(data = tot_spent_flavor |>
filter(region == "Central") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "East") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "South") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "West") |>
arrange(desc(flav_spent)) |>
head(5)) +
facet_wrap(~ region,
scales = "free_x",
nrow = 1) +
theme_bw()+
theme(legend.position = "bottom",
legend.key.size = unit(8, "pt"),
axis.text.x = element_text("none"))+
scale_fill_viridis_d()+
scale_y_continuous(labels = scales :: dollar) +
labs(x = "",
y = "Total Money Spent",
title = "Top 5 Flavors Sold by Region",
fill = "Flavor")
ggplot(data = tot_spent_flavor,
mapping = aes(x = fct_reorder(flavor_descr,
flav_spent,
na.rm = T),
y = flav_spent,
fill = flavor_descr))+
geom_col(data = tot_spent_flavor |>
filter(region == "Central") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "East") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "South") |>
arrange(desc(flav_spent)) |>
head(5)) +
geom_col(data = tot_spent_flavor |>
filter(region == "West") |>
arrange(desc(flav_spent)) |>
head(5)) +
facet_wrap(~ region,
scales = "free_x",
nrow = 1) +
theme_bw()+
theme(legend.position = "bottom",
legend.key.size = unit(8, "pt"),
axis.text.x = element_blank())+
scale_fill_viridis_d()+
scale_y_continuous(labels = scales :: dollar) +
labs(x = "",
y = "Total Money Spent",
title = "Top 5 Flavors Sold by Region",
fill = "Flavor")
